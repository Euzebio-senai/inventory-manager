<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EasyStock - Controle de Estoque</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Overlay para mobile -->
    <div class="overlay" id="overlay" onclick="toggleSidebar()"></div>
    
    <header class="header">
        <div class="header-left">
            <button class="menu-toggle" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>
            <div class="logo">
                <i class="fas fa-boxes"></i>
                EasyStock
            </div>
        </div>
        <div class="header-controls">
            <div class="user-info">
                <i class="fas fa-user-circle"></i>
                <span id="user-name">Admin</span>
            </div>
            <button class="theme-toggle" onclick="toggleTheme()" title="Alternar Tema">
                <i class="fas fa-moon" id="theme-icon"></i>
            </button>
            <div class="notifications" onclick="toggleNotifications()">
                <i class="fas fa-bell"></i>
                <span class="notification-badge" id="notification-count">0</span>
                <div class="notifications-dropdown" id="notifications-dropdown">
                    <h4>Notificações</h4>
                    <div id="notifications-list">
                        <p>Nenhuma notificação</p>
                    </div>
                </div>
            </div>
            <button class="btn btn-outline" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                Sair
            </button>
        </div>
    </header>

    <nav class="sidebar" id="sidebar">
        <div class="nav-item active" onclick="showSection('dashboard')">
            <i class="fas fa-chart-dashboard"></i>
            <span>Dashboard</span>
        </div>
        <div class="nav-item" onclick="showSection('produtos')">
            <i class="fas fa-box"></i>
            <span>Produtos</span>
        </div>
        <div class="nav-item" onclick="showSection('categorias')">
            <i class="fas fa-tags"></i>
            <span>Categorias</span>
        </div>
        <div class="nav-item" onclick="showSection('fornecedores')">
            <i class="fas fa-building"></i>
            <span>Fornecedores</span>
        </div>
        <div class="nav-item" onclick="showSection('movimentacao')">
            <i class="fas fa-exchange-alt"></i>
            <span>Movimentação</span>
        </div>
        <div class="nav-item" onclick="showSection('vendas')">
            <i class="fas fa-shopping-cart"></i>
            <span>Vendas</span>
        </div>
        <div class="nav-item" onclick="showSection('compras')">
            <i class="fas fa-shopping-bag"></i>
            <span>Compras</span>
        </div>
        <div class="nav-item" onclick="showSection('clientes')">
            <i class="fas fa-users"></i>
            <span>Clientes</span>
        </div>
        <div class="nav-item" onclick="showSection('relatorios')">
            <i class="fas fa-chart-line"></i>
            <span>Relatórios</span>
        </div>
        <div class="nav-item" onclick="showSection('backup')">
            <i class="fas fa-database"></i>
            <span>Backup</span>
        </div>
        <div class="nav-item" onclick="showSection('configuracoes')">
            <i class="fas fa-cog"></i>
            <span>Configurações</span>
        </div>
    </nav>

    <main class="main-content">
        <!-- Dashboard -->
        <section id="dashboard" class="content-section active">
            <div class="page-header">
                <h1><i class="fas fa-chart-dashboard"></i> Dashboard</h1>
                <div class="page-actions">
                    <button class="btn btn-primary" onclick="atualizarDashboard()">
                        <i class="fas fa-sync-alt"></i> Atualizar
                    </button>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card primary">
                    <div class="stat-icon"><i class="fas fa-box"></i></div>
                    <div class="stat-content">
                        <div class="stat-number" id="total-produtos">0</div>
                        <div class="stat-label">Total de Produtos</div>
                    </div>
                </div>
                <div class="stat-card success">
                    <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                    <div class="stat-content">
                        <div class="stat-number" id="produtos-estoque">0</div>
                        <div class="stat-label">Em Estoque</div>
                    </div>
                </div>
                <div class="stat-card warning">
                    <div class="stat-icon"><i class="fas fa-exclamation-triangle"></i></div>
                    <div class="stat-content">
                        <div class="stat-number" id="produtos-baixo">0</div>
                        <div class="stat-label">Estoque Baixo</div>
                    </div>
                </div>
                <div class="stat-card info">
                    <div class="stat-icon"><i class="fas fa-dollar-sign"></i></div>
                    <div class="stat-content">
                        <div class="stat-number" id="valor-total">R$ 0,00</div>
                        <div class="stat-label">Valor Total</div>
                    </div>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-exclamation-triangle"></i> Produtos com Estoque Baixo</h3>
                        <button class="btn btn-sm" onclick="exportarEstoqueBaixo()">
                            <i class="fas fa-download"></i> Exportar
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Produto</th>
                                    <th>Estoque Atual</th>
                                    <th>Estoque Mínimo</th>
                                    <th>Status</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="produtos-baixo-estoque">
                                <tr>
                                    <td colspan="5" class="text-center">Nenhum produto com estoque baixo</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-line"></i> Movimentações Recentes</h3>
                    </div>
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Produto</th>
                                    <th>Tipo</th>
                                    <th>Quantidade</th>
                                </tr>
                            </thead>
                            <tbody id="movimentacoes-recentes">
                                <tr>
                                    <td colspan="4" class="text-center">Nenhuma movimentação recente</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Produtos -->
        <section id="produtos" class="content-section">
            <div class="page-header">
                <h1><i class="fas fa-box"></i> Produtos</h1>
                <div class="page-actions">
                    <button class="btn btn-success" onclick="openModal('produto-modal')">
                        <i class="fas fa-plus"></i> Novo Produto
                    </button>
                    <button class="btn btn-info" onclick="importarProdutos()">
                        <i class="fas fa-upload"></i> Importar
                    </button>
                    <button class="btn btn-warning" onclick="exportarProdutos()">
                        <i class="fas fa-download"></i> Exportar
                    </button>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <div class="search-filters">
                        <div class="search-bar">
                            <i class="fas fa-search"></i>
                            <input type="text" class="search-input" placeholder="Pesquisar produtos..." 
                                   onkeyup="filterTable('produtos-table', this.value)">
                        </div>
                        <select class="form-control" onchange="filtrarPorCategoria(this.value)" id="filter-categoria">
                            <option value="">Todas as categorias</option>
                        </select>
                        <select class="form-control" onchange="filtrarPorStatus(this.value)">
                            <option value="">Todos os status</option>
                            <option value="normal">Estoque Normal</option>
                            <option value="baixo">Estoque Baixo</option>
                            <option value="zerado">Sem Estoque</option>
                        </select>
                    </div>
                </div>

                <div class="table-responsive">
                    <table class="table" id="produtos-table">
                        <thead>
                            <tr>
                                <th><input type="checkbox" onchange="selecionarTodos(this)"></th>
                                <th onclick="ordenarTabela('produtos-table', 1)">Código <i class="fas fa-sort"></i></th>
                                <th onclick="ordenarTabela('produtos-table', 2)">Nome <i class="fas fa-sort"></i></th>
                                <th>Categoria</th>
                                <th onclick="ordenarTabela('produtos-table', 4)">Estoque <i class="fas fa-sort"></i></th>
                                <th onclick="ordenarTabela('produtos-table', 5)">Preço <i class="fas fa-sort"></i></th>
                                <th>Status</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="produtos-list">
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Vendas -->
        <section id="vendas" class="content-section">
            <div class="page-header">
                <h1><i class="fas fa-shopping-cart"></i> Vendas</h1>
                <div class="page-actions">
                    <button class="btn btn-success" onclick="openModal('venda-modal')">
                        <i class="fas fa-plus"></i> Nova Venda
                    </button>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <div class="search-filters">
                        <div class="search-bar">
                            <i class="fas fa-search"></i>
                            <input type="text" class="search-input" placeholder="Pesquisar vendas...">
                        </div>
                        <input type="date" class="form-control" id="data-inicio">
                        <input type="date" class="form-control" id="data-fim">
                        <button class="btn btn-primary" onclick="filtrarVendasPorData()">Filtrar</button>
                    </div>
                </div>

                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Nº Venda</th>
                                <th>Data</th>
                                <th>Cliente</th>
                                <th>Valor Total</th>
                                <th>Status</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="vendas-list">
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Clientes -->
        <section id="clientes" class="content-section">
            <div class="page-header">
                <h1><i class="fas fa-users"></i> Clientes</h1>
                <div class="page-actions">
                    <button class="btn btn-success" onclick="openModal('cliente-modal')">
                        <i class="fas fa-plus"></i> Novo Cliente
                    </button>
                </div>
            </div>
            
            <div class="card">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Email</th>
                                <th>Telefone</th>
                                <th>CPF/CNPJ</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="clientes-list">
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Backup -->
        <section id="backup" class="content-section">
            <div class="page-header">
                <h1><i class="fas fa-database"></i> Backup e Restauração</h1>
            </div>
            
            <div class="backup-grid">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-save"></i> Criar Backup</h3>
                    </div>
                    <div class="card-body">
                        <p>Crie um backup completo dos seus dados para manter suas informações seguras.</p>
                        <div class="backup-options">
                            <label class="checkbox-label">
                                <input type="checkbox" checked> Produtos
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" checked> Categorias
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" checked> Fornecedores
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" checked> Movimentações
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" checked> Vendas
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" checked> Clientes
                            </label>
                        </div>
                        <button class="btn btn-primary btn-block" onclick="criarBackup()">
                            <i class="fas fa-download"></i> Criar Backup
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-upload"></i> Restaurar Backup</h3>
                    </div>
                    <div class="card-body">
                        <p>Restaure seus dados a partir de um arquivo de backup.</p>
                        <div class="file-upload">
                            <input type="file" id="backup-file" accept=".json" onchange="validateBackupFile(this)">
                            <label for="backup-file" class="file-upload-label">
                                <i class="fas fa-cloud-upload-alt"></i>
                                Escolher arquivo de backup
                            </label>
                        </div>
                        <button class="btn btn-warning btn-block" onclick="restaurarBackup()" id="restore-btn" disabled>
                            <i class="fas fa-upload"></i> Restaurar Backup
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-clock"></i> Backups Automáticos</h3>
                    </div>
                    <div class="card-body">
                        <p>Configure backups automáticos para proteger seus dados.</p>
                        <div class="form-group">
                            <label class="form-label">Frequência</label>
                            <select class="form-control">
                                <option>Diário</option>
                                <option>Semanal</option>
                                <option>Mensal</option>
                            </select>
                        </div>
                        <button class="btn btn-info btn-block">
                            <i class="fas fa-cog"></i> Configurar
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Outras seções existentes continuam igual... -->
        <!-- [Mantenho as outras seções como categorias, fornecedores, movimentacao, relatorios, configuracoes] -->
    </main>

    <!-- Modais -->
    <!-- Modal Venda -->
    <div id="venda-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3><i class="fas fa-shopping-cart"></i> Nova Venda</h3>
                <span class="close" onclick="closeModal('venda-modal')">&times;</span>
            </div>
            <form onsubmit="salvarVenda(event)">
                <div class="modal-body">
                    <div class="form-row">
                        <div class="form-group col-6">
                            <label class="form-label">Cliente</label>
                            <select class="form-control" id="venda-cliente" required>
                                <option value="">Selecione um cliente</option>
                            </select>
                        </div>
                        <div class="form-group col-6">
                            <label class="form-label">Data da Venda</label>
                            <input type="date" class="form-control" id="venda-data" required>
                        </div>
                    </div>
                    
                    <div class="produtos-venda">
                        <h4>Produtos</h4>
                        <div class="produto-item">
                            <select class="form-control" onchange="carregarInfoProduto(this, 0)">
                                <option value="">Selecione um produto</option>
                            </select>
                            <input type="number" class="form-control" placeholder="Qtd" min="1" onchange="calcularTotal()">
                            <input type="number" class="form-control" placeholder="Preço" step="0.01" onchange="calcularTotal()" readonly>
                            <input type="number" class="form-control" placeholder="Total" readonly>
                            <button type="button" class="btn btn-danger btn-sm" onclick="removerProdutoVenda(0)">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    
                    <button type="button" class="btn btn-secondary" onclick="adicionarProdutoVenda()">
                        <i class="fas fa-plus"></i> Adicionar Produto
                    </button>
                    
                    <div class="venda-totals">
                        <div class="total-item">
                            <span>Subtotal:</span>
                            <span id="venda-subtotal">R$ 0,00</span>
                        </div>
                        <div class="total-item">
                            <span>Desconto:</span>
                            <input type="number" id="venda-desconto" step="0.01" value="0" onchange="calcularTotal()">
                        </div>
                        <div class="total-item total-final">
                            <span>Total:</span>
                            <span id="venda-total">R$ 0,00</span>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-save"></i> Finalizar Venda
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('venda-modal')">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Cliente -->
    <div id="cliente-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user"></i> Cadastrar Cliente</h3>
                <span class="close" onclick="closeModal('cliente-modal')">&times;</span>
            </div>
            <form onsubmit="salvarCliente(event)">
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Nome/Razão Social</label>
                        <input type="text" class="form-control" id="cliente-nome" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-6">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-control" id="cliente-email">
                        </div>
                        <div class="form-group col-6">
                            <label class="form-label">Telefone</label>
                            <input type="text" class="form-control" id="cliente-telefone">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-6">
                            <label class="form-label">CPF/CNPJ</label>
                            <input type="text" class="form-control" id="cliente-documento">
                        </div>
                        <div class="form-group col-6">
                            <label class="form-label">Tipo</label>
                            <select class="form-control" id="cliente-tipo">
                                <option value="fisica">Pessoa Física</option>
                                <option value="juridica">Pessoa Jurídica</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Endereço</label>
                        <textarea class="form-control" id="cliente-endereco"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-save"></i> Salvar
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('cliente-modal')">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <script src="script.js"></script>
</body>
</html>